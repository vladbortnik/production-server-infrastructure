# Security Headers Configuration for Nginx
# Include this file in your server blocks: include /etc/nginx/snippets/security-headers.conf;
# This configuration achieves A+ ratings on SSL Labs and HTTP Observatory

# X-Frame-Options
# Prevents clickjacking attacks by controlling whether the browser should be allowed to render a page in a <frame>, <iframe>, <embed> or <object>
add_header X-Frame-Options "SAMEORIGIN" always;

# X-Content-Type-Options
# Prevents MIME type sniffing which can lead to XSS attacks
add_header X-Content-Type-Options "nosniff" always;

# Referrer Policy
# Controls how much referrer information should be included with requests
add_header Referrer-Policy "strict-origin-when-cross-origin" always;

# Permissions Policy (formerly Feature Policy)
# Controls which features and APIs can be used in the browser
add_header Permissions-Policy "camera=(), microphone=(), geolocation=(), payment=()" always;

# Content Security Policy (CSP)
# Helps prevent XSS attacks by controlling which resources can be loaded
# Note: Customize this based on your application's needs
add_header Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-eval' 'unsafe-inline' https://fonts.googleapis.com; img-src 'self' data: blob:; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com data:; connect-src 'self';" always;

# X-XSS-Protection
# Enables the Cross-site scripting (XSS) filter built into most modern web browsers
# Note: Deprecated in favor of CSP, but included for legacy browser support
add_header X-XSS-Protection "1; mode=block" always;

# Additional Security Headers

# Expect-CT (Certificate Transparency)
# Helps detect and prevent the use of misissued certificates
add_header Expect-CT "max-age=86400, enforce" always;

# Remove Server Header (nginx version information)
# This is configured in nginx.conf, but mentioned here for completeness
# server_tokens off;
